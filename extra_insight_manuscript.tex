\documentclass[times, twoside, watermark]{zHenriquesLab-StyleBioRxiv}
\usepackage{booktabs}
\usepackage{lineno}
\usepackage{xr}

% To handle cross-referencing between documents
\makeatletter
\newcommand*{\addFileDependency}[1]{% argument=file name and extension
  \typeout{(#1)}
  \@addtofilelist{#1}
  \IfFileExists{#1}{}{\typeout{No file #1.}}
}
\makeatother

\newcommand*{\myexternaldocument}[1]{%
    \externaldocument{#1}%
    \addFileDependency{#1.tex}%
    \addFileDependency{#1.aux}%
}

\myexternaldocument{extra_insight_supplement}

% add this for ref animation
\usepackage{prettyref}
\newrefformat{Sfig}{fig. S\ref{#1}}
\newrefformat{fig}{fig. \ref{#1}}

% command to indicate text WIP
\newcommand{\placeholder}{\textbf{(placeholder)}}

\title{Non-coding ultra-strong selection in the human genome varies by regulatory role and phylogenetic conservation}
\leadauthor{Dukler}
\shorttitle{ExtRaINSIGHT}
\author[$\ast$, 1]{Noah Dukler}
\author[ $\dagger$, 1]{Yi-Fei Huang}
\author[$\ast$, 2, \Letter]{Adam Siepel}

\affil[$\ast$]{Simons Center for Quantitative Biology, Cold Spring Harbor Laboratory, Cold Spring Harbor, NY}
\affil[$\dagger$]{Department of Biology and Huck Institutes of the Life Sciences, University Park, PA}

\begin{document}

\maketitle

\begin{keywords}
Selection | Population Genetics | Human Genetics
\end{keywords}

\begin{abstract}
The rapid expansion of human population whole genome sequencing data has resulted in an extensive catalog of rare variation. We use this rare variation as a proxy for \textit{de novo} mutation and construct a context-dependent model to predict rates of mutation genome-wide. The model also implicitly corrects for local factors, like replication timing, which are known to influence mutation rate using variation in the rates of rare variants in proximal neutral regions. We then compare the predicted versus observed rates of rare variation for groups of elements and discover those with fewer rare variants than expected. This depletion in rare variation is caused by strong purifying selection on the collection of elements where any mutation results in a large fitness penalty. We contrast this measure of strong selection with a measure of generalized selection to estimate the relative fraction of sites under weak and strong selection across both coding and non-coding regions. Consistent with previous work we find that the genes associated with neuronal function are most strongly depleted for rare variation while those associated with reproduction enriched relative the genomic background. By applying our method to non-coding regions we find that splice sites are the most strongly conserved followed by conserved microRNAs which show less variation than non-degenerate coding regions. Surprisingly we observe relatively little ultra-strong selection in humans in non-coding regions that show strict and deep phylogenetic conservation suggesting that they may be maintained by either pervasive weak selection or are tolerant to heterozygous mutation.  We also observed excess rare variation across a variety of elements that are inherently tied to biochemical function indicating that improvements in separating selection and mutation will require new approaches. Finally we have made the method we developed for this analysis, ExtRaINSIGHT, available as a web-tool for others to use.

\end{abstract}

\section*{Introduction}

Recent efforts at cataloging human genetic variation such as the 1000 Genomes Project (cite) and the Simons Genomic Diversity Panel (cite) resulted in extensive annotation of common genetic variants. These variants have illuminated a complex history of migration and admixture, both within modern humans and in their interactions with archaic hominins. Inferring demographic histories and distributions of selective effects have been the two most ubiquitous goals in population genetics, and while common variants have been essential for the former, they have had limited power for the latter. Usually, the presence of purifying selection is detected by a depletion of genetic variation within a region, however common variants are unable to differentiate between sites under weak or strong selection as both will prevent a variant from rising to high frequency in a population (cite). Recent projects with the aim of massively expanding the number of sequenced whole genomes such as (...) have provided an expansive view of rare human variation not previously available. Unlike common variants, rare variants are not efficient for inferring broad population structure but they can be used to differentiate between weak and strong purifying selection (cite).

Several approaches have been developed that utilize rare variation data to find collections of sites that show extreme depletion for such variants (cite UNEECON, petrovski 2013, etc. ). One of the most widely used of these is pLI (cite) which uses loss-of-function (LoF) variants to label proteins as being haplo-insufficient (intolerant to single copy loss) or haplosufficent. Rare variation is associated with haplosufficiency because rare variants are almost always heterozygous, thus a depletion of a rare variant is usually observed as intolerance to even a single copy of that variant. Other approaches such as CCR (cite - Havrilla 2019) have improved upon the resolution of pLI, looking for signals of ultra-strong constraint at the sub-domain level. A caveat that was raised in recent commentary has pointed is that approaches like pLI ``reflect the strength of selection acting on heterozygotes and not dominance or haploinsufficiency''(cite - Fuller 2019). Thus signals of constraint from rare variants are actually the product of the dominance coefficient $d$ and the selection coefficient $s$.

While these methods are all quite powerful, because they exploit the DNA to protein sequence mapping, they apply solely to coding regions. This excludes $\backsim 99\%$ of the genome from analysis, excluding a number of interesting regions (including ultra-conserved non-coding elements) from analysis. We developed ExtRaINSIGHT to overcome this limitation, at the cost of some nuance in protein coding regions, by creating a globally applicable model for the probability of observing rare variants in neutrally evolving regions. This work probes the role of strong selection in shaping both coding and non-coding elements stratified by function.

\section*{Materials and Methods}
\label{sec:materials:methods}
\subsection*{Creating a neutral mutation model}

To get a collection of rare variants to serve as a proxy for \textit{de novo} mutations, we filtered the gnomAD (v3) database (cite) keeping SNPs with an allele frequency of $\leq 0.001$. We removed all CpG sites to avoid the effects of methylation on CpG mutation and sites with an average sequencing coverage of $<20$. To calibrate the mutation model we needed a set of neutral regions for which we used the set we defined for the INSIGHT method(cite), lifting over to hg38 when necessary(cite liftOver). Finally, we constructed a set of features per allele at every site in the genome to be used in the mutation model. There were four features in the mutation model: frequency of each possible mutation given the 7-mer context in neutral regions, the log sequencing coverage, percent GC content in a 200bp window centered on the variant, and whether the SNP was in a CpG island based on \placeholder \textit{et al.}. We subsampled $1\%$ of mutations in these neutral regions and fit a logistic model to create a global model of \textit{de novo} mutation probabilities absent selection. To adjust for local factors that cause variation in the mutation rate (e.g. replication timing and recombination rate, cite), we tiled the genome into 50kb bins, then used the neutral variants per focal tile and flanking tiles with the mutation probability predicted from the global model as the only feature (plus an intercept) to produce a locally adjusted estimate of the mutation rate per variant. This procedure provides globally well calibrated estimates of mutation rates across all mutational frequencies (\ref{Sfig:mutation_model_calibration}).

\subsection*{Estimating the fraction of sites that are intolerant to heterozygous mutation}
Using our predictions to provide the rate of mutation ($P_i$) for any given site ($i$ under neutrality and assuming independence of sites we can detect deviations from the neutral mutation model by fitting this binomial likelihood model:

\begin{equation}
\mathcal{L}(\lambda ;\mathbb{Y},\mathbb{P}) = \prod_i ((1-\lambda_s) \cdot P_i)^{Y_i}(1- (1-\lambda_s) P_i)^{1-Y_i}
\end{equation}

\noindent where $\lambda_s$ is the scale factor capturing a depletion of rare genetic variation and $Y_i$ is an indicator variable for the presence of mutation $i$ in the sample. As noted previously, this observed depletion of rare variants is due to both dominance and selection, so $\lambda_s$ represents the fraction of sites where the combination of both factors is sufficiently deleterious for new mutations that even rare variants are not observed. As shorthand for this concept we will refer to $\lambda_s$ as measuring the fraction of sites under ultra-strong selection where larger values correspond to more sites under ultra-strong purifying selection. We then compute both a standard error using the curvature of the likelihood surface and a p-value using a likelihood ratio test for the following hypothesis set.

\begin{align}
H_0\text{(no selection) : } & \lambda_s = 0\\
H_1\text{(under selection) : } & \lambda_s \neq 0
\end{align}

Unlike other approaches (such as pLI) for detecting intolerance to rare variants, ExtRaINSIGHT is agnostic with regard to the functional impact of the rare variants in its database, and thus can be applied to both coding and non-coding regions.

\subsection*{Calculating the total number of sites under purifying selection}
By design, ExtRaINSIGHT will not detect weak purifying selection acting upon a region because it analyzes only rare variants. To contrast the relative abundances of weak and strong selection in a set of sites we turn to $\rho$, the metric for fraction of sites under combined weak and strong purifying selection introduced by the INSIGHT method. For this work we calculate $\rho$ using the updated version of INSIGHT, INSIGHT2 (cite). INSIGHT2 is only available on \textit{hg19} so only sites that have a 1-1 mapping between \textit{hg19} and \textit{hg38} are used in all analysis. Furthermore, all annotation sets with more than one million sites were sub-sampled to one million for computational efficiency unless otherwise stated.

\section*{Results}

\subsection*{ExtRaINSIGHT is consistent with other measures of strong coding constraint}
As a validation for ExtRaINSIGHT we compared it with another method for detecting genes that were intolerant to heterozygous loss of function (LoF) variants, pLI. Genes were classified as rare variant tolerant (pLI $\leq 0.1$) or intolerant (pLI $\geq 0.9$). ExtRaINSIGHT found similar results to pLI using all CDS sites, with a larger fraction of sites being intolerant of heterozygous variants in genes that were classified as rare variant intolerant by pLI.  (As a secondary validation do we want to estimate per gene extraINSIGHT scores and show they similar, but probably slightly worse than pLI at prioritizing known recessive disease genes?) 

We then sought to estimate the relative fraction of sites under strong vs. weak selection by taking the ratio of $\lambda_s$ and $\rho$, a measure of the combined fraction of weak and strong selection presented in INSIGHT (cite). This ratio serves two purposes (1) de-convolving the relative contributions of weak and strong selection to the observed pattern of polymorphism and (2) controlling for the fraction of sites under purifying selection, allowing for more rigorous comparisons across annotations of varying quality. To have a baseline against which to compare the relative roles of weak and strong selection we estimate $\rho$ and $\lambda_s$ for coding and non-coding regions on a random subset of fifteen million sites for each. Using INSIGHT2 we find estimates of generalized purifying selection ( $\rho$ ) of $0.62$ for coding regions and $0.07$ consistent with previous findings. Applying ExtRaINSIGHT, we obtained estimates of $0.145$ and $0.008$ for the fraction of sites under ultra-strong selection for coding and non-coding sites, respectively. By taking the ratio $\frac{\lambda_s}{\rho}$, we find that $23.3\%$ of sites under purifying selection are under ultra-strong selection. In contrast the same calculation for non-coding elements results in an estimate of only $11.5\%$. Thus we find that strong selection is roughly twice as prevalent in coding elements as non-coding elements.

With this genome-wide baseline in hand we do the same calculation for the two categories of pLI genes previously described. Not only do genes high pLI scores show larger fraction of sites under purifying selection than those with low scores ($\backsim 0.76$ vs. $\backsim 0.6$), sites that are under purifying selection are roughly two and half times as likely to be under ultra-strong selection. This is consistent with the expectation organismal fitness is less impacted by single copy mutations in genes with low pLI, even those in functionally important sites, than those with high pLI scores.

\begin{figure*}[t]
    \centering
    \includegraphics[width=0.5\linewidth]{figures/pLI_ratio.pdf}
    \caption{\textbf{Comparison of pLI and ExtRaINSIGHT scores in CDS}}
    \label{fig:pli}
\end{figure*}

\begin{table*}[t]
    \centering
	\begin{tabular}{@{}llll@{}}
		\toprule
		Region     & $\rho$ & $\lambda_s$ & ratio  \\ \midrule
		Coding     & 0.6219 & 0.1449     & 0.2330 \\
		Non-coding & 0.0664 & 0.0076     & 0.1150 \\ \bottomrule
	\end{tabular}
	\caption{\textbf{Genome-wide estimates of generalized and strong selection.} Estimates were computed using  based on a random set 15 million sites per category. }
	\label{tab:genome_wide_scores}
\end{table*}

\subsection*{Excess strong selection in neuronal genes}

Previous works has shown that the strength of selection on coding sequence varies between different classes of genes. We sought to investigate this with ExtRaINSIGHT by subdividing genes into distinct functional groups using top-level Reactome annotations and estimating the amount of ultra-strong selection in each class. Gene associated with neuronal system showed the highest relative abundance of strong selection in line with previous work studying autism showing that strong selection is prevalent in neuronal genes (cite pLI, ExAC?)(\prettyref{fig:reactome}). Autophagy was the next most enriched category of genes, likely because of the documented role of autophagy genes in neurodegenerative disorders (Stamatoku et al. 2020). Other categories that showed relatively large fractions of sites under ultra-strong selection include muscle contraction, DNA replication genes, and metabolism of RNA. Metabolism of RNA includes the genes responsible for splicing, so it is perhaps not surprising to see them here as splice sites themselves are particularly intolerant to mutation (cite Zhang 2018). Surprisingly, given that they are the canonical example for dosage sensitive genes (cite), genes annotated as being involved in gene expression (largely TFs) were not among those most enriched for strong selection. At the other extreme genes associated with reproduction showed the smallest role for strong selection as has been previously reported (cite). Unsurprisingly, metabolic genes, the canonical example for dosage insensitive genes, were also near the bottom of the list.

Where possible we sought to confirm these results using tissue specific gene expression as a source for orthogonal annotations. Genes were annotated as being specific to a given tissue using the ZZZ metric (cite) computed from GTEx data. All the genes most enriched for strong selection were tissue specific to various regions of the brain (\prettyref{Sfig:tissue_specific_scores}) supporting our previously seen enrichment for strong selection in nervous system genes. For reproductive genes the evidence is more mixed with neither ovaries nor testis coming out at the bottom of the list. (Not sure how to wrap this up)

\begin{figure*}[t]
    \centering
    \includegraphics[width=\linewidth]{figures/reactome_cds_ratio.pdf}
    \caption{\textbf{\textbf{ExtRaINSIGHT scores in CDS stratified by biological pathway}}}
    \label{fig:reactome}
\end{figure*}

\subsection*{Conserved microRNAs are strongly constrained}
While ExtRaINSIGHT can be applied to coding regions it distinguishes itself from previous work by being equally applicable to non-coding regions. However, one of the major challenges of studying the relative role of selection between types of non-coding sequence is the varying imprecision of most non-coding annotations. Thus, to investigate the role of ultra-strong in non-coding regions we chose core splice sites and microRNAs because of their characterized biochemical function and contrasted them with 1D coding sequence. Splice sites were under incredibly strong selection with $\backsim45\%$ of sites being depleted for rare variation, twice the rate seen in 1D CDS. Both seed and non-seed regions of conserved microRNAs also showed $50\%-70\%$more strong selection than 1D CDS (\prettyref{fig:micro_rnas}A). This is likely due to the extreme dependence of microRNA function on a specific sequence and the highly pleiotropic effects of disrupting one (cite). In contrast, non-conserved microRNAs no evidence of strong selection.

\begin{figure*}[t]
    \centering
    \includegraphics[width=\linewidth]{figures/microRNA_constraint.pdf}
    \caption{\textbf{\textbf{Heterozygous mutations in conserved microRNAs are under stronger selection than those in CDS}}}
    \label{fig:micro_rnas}
\end{figure*}

\subsection*{Human accelerated and ultra-conserved regions show surprisingly similar amounts of ultra-strong selection}

Next we investigated two types of regions under dramatically different patterns of phylogenetic constraint. Ultra-conserved non-coding elements (UCNEs) are defined by extreme sequence conservation across broad swaths of phylogenetic time. In contrast human accelerated regions (HARs) show an excess of substitutions along the human lineage suggesting adaptation may be taking place (Pollard et al 2006). Naively we would expect that UCNEs would be extremely intolerant to mutation becasue of their deep conservation however that is not the case. Only $\backsim 9\%$ of sites in UCNEs show evidence of ultra-strong purifying selection (\prettyref{fig:micro_rnas}B). There are several possible explanations for this: (1) UCNEs may largely be haplosufficent so heterzyogous variation is well tolerated, or (2) that UCNEs are under pervasive weak selection such that mutations are tolerated at the individual level but are sufficient to maintain near sequence identity across phylogenetic time. There is some evidence for this based on work in mice where deletions of UCNEs yielded viable and fertile individuals with no other obvious phenotypic defects (Ahituv et al. 2007). More recent work has provided examples of UCNEs that are haploinsufficient (Bhatia et al. 2013) or whose homozygous deletion leads to developmental defects (Dickel et al. 2018) but even in these cases individuals with these defects remained viable and fertile.

If UCNEs show unexpectedly little evidence of ultra-strong selection, HARs show a surprising amount despite also being almost entirely non-coding. Roughly $5\%$ of sites in HARs show ultra-strong selection, half that of UCNEs, despite being much more recently evolved. Several lines of evidence have implicated HARs in neuronal function with mutations in those regions being associated with cognitive disorders (Doan et al. 2016, Won et al 2019, Ryu et al 2018). This shows that just because function is recently evolved does not preclude it from being under ultra strong selection. 

\subsection*{Neutral mutation model mis-specification is observed due to hyper-local mutation rate variation is associated with TF binding}

ExtRaINSIGHT relies upon a neutral mutation model calibrated using putatively neutral regions to make inferences about whether a given set of sites is depleted or enriched for ultra-rare variants. In addition to sequence context the model adjusts for local mutation rate variation and excludes CpG sites to avoid issues arising from methylation dependent variation in mutation rate. This model is globally well calibrated across the whole spectrum of predicted mutation probabilities (supplemental figure 2). Despite this we observed that sets of sites that we would expect to be under selection were in fact inferred to have excesses of rare variation. This effect was most pronounced in the 1kb directly upstream of transcription start sites (TSS) and to a far lesser degree at 4D sites but not near the transcription termination sites (TTS)( \prettyref{fig:mutation_model_misspec} ). Given that it has been shown that proximal promoter region is under purifying selection (cite) we hypothesized that this is due to a local elevation of mutation rates directly upstream of TSS  (as has been shown in other species?(cite)). We further narrowed our focus to TFBS which have been previously observed to have elevated mutation rates (cite). When we looked within cannonical TFBS motifs we observed an excess of rare variants, even more so than in the X bp directly flankning the TFBS. This suggests that there are hyper-local determinants of mutation rate, in this case likely that the binding of TFs is itself mutagenic (cite). This poses a fundamental problem, all neutral models to date assume that mutation and function that exposes genomic sequence to selection can be decoupled for the purposes of estimating a neutral model, which does not hold here as TF binding is both inherently functional and mutagenic. Addressing this challenge will be critical not only for traditional evolutionary models but particularly for application in oncogenomics where excess mutations could give false signals of recurrent mutation leading to erroneous identification of cancer drivers (see discussion).

\begin{figure*}[t]
    \centering
    \includegraphics[width=\linewidth]{figures/excess_mutation_rate.pdf}
    \caption{\textbf{\textbf{TFBS show elevated mutation rates}}}
    \label{fig:mutation_model_misspec}
\end{figure*}

\section*{Discussion}

\subsection*{Data Availability}

ExtRaINSIGHT and INSIGHT2 scores can be computed for a set of annotations using the ExtRaINSIGHT web portal at \url{http://compgen.cshl.edu/extrainsight}. All pipeline and analysis for this paper can be viewed on github at \placeholder.

\bibliography{example-bibliography}

\end{document}